

import requests
import json



'''
vulnconf = ["cpe:2.3:a:elastic:elasticsearch:7.10.1:*:*:*:*:*:*:*","cpe:2.3:a:pivotal_software:rabbitmq:3.8.0:-:*:*:*:*:*:*" ]
def jsonCreate(vulnlist):
    jsonlist = []
    for item in vulnlist:
        query = '{ "retrieve": "cves", "dict_filter": { "vulnerable_configuration": "'+item+'" }, "limit": 10, "query_filter": { "access": 0, "cwe": 0, "vulnerable_configuration": 0, "vulnerable_product": 0 } }'
        jsonlist.append(query)
    return jsonlist
'''

def getblock():
    URL = 'https://vuln.sentnl.io/api/query'
    JSON =  [ { "retrieve": "cves", "dict_filter": { "vulnerable_configuration": "cpe:2.3:a:elastic:elasticsearch:7.10.1:*:*:*:*:*:*:*" }, "limit": 10, "query_filter": { "access": 0, "cwe": 0, "vulnerable_configuration": 0, "vulnerable_product": 0 } },
              { "retrieve": "cves", "dict_filter": { "vulnerable_configuration": "cpe:2.3:a:pivotal_software:rabbitmq:3.8.0:-:*:*:*:*:*:*" }, "limit": 10, "query_filter": { "access": 0, "cwe": 0, "vulnerable_configuration": 0, "vulnerable_product": 0 } },
              { "retrieve": "cves", "dict_filter": { "vulnerable_configuration": "cpe:2.3:a:elastic:kibana:7.10.1:*:*:*:*:*:*:*" }, "limit": 10, "query_filter": { "access": 0, "cwe": 0, "vulnerable_configuration": 0, "vulnerable_product": 0 } } ,
              { "retrieve": "cves", "dict_filter": { "vulnerable_configuration": "cpe:2.3:a:redislabs:redis:5.0.9:*:*:*:*:*:*:*" }, "limit": 10, "query_filter": { "access": 0, "cwe": 0, "vulnerable_configuration": 0, "vulnerable_product": 0 } } ,
              { "retrieve": "cves", "dict_filter": { "vulnerable_configuration": "cpe:2.3:a:fastify:fastify:2.14.1:*:*:*:*:node.js:*:*" }, "limit": 10, "query_filter": { "access": 0, "cwe": 0, "vulnerable_configuration": 0, "vulnerable_product": 0 } } ,
              { "retrieve": "cves", "dict_filter": { "vulnerable_configuration": "cpe:2.3:a:lodash:lodash:4.17.12:*:*:*:*:node.js:*:*" }, "limit": 10, "query_filter": { "access": 0, "cwe": 0, "vulnerable_configuration": 0, "vulnerable_product": 0 } } ,
              { "retrieve": "cves", "dict_filter": { "vulnerable_configuration": "cpe:2.3:a:momentjs:moment:2.27.0:*:*:*:*:node.js:*:*" }, "limit": 10, "query_filter": { "access": 0, "cwe": 0, "vulnerable_configuration": 0, "vulnerable_product": 0 } } ,
              { "retrieve": "cves", "dict_filter": { "vulnerable_configuration": "cpe:2.3:a:node-fetch_project:node-fetch:3.0.0:beta8:*:*:*:node.js:*:*" }, "limit": 10, "query_filter": { "access": 0, "cwe": 0, "vulnerable_configuration": 0, "vulnerable_product": 0 } } ,
              { "retrieve": "cves", "dict_filter": { "vulnerable_configuration": "cpe:2.3:a:socket:engine.io-client:2.3.0:*:*:*:*:node.js:*:*" }, "limit": 10, "query_filter": { "access": 0, "cwe": 0, "vulnerable_configuration": 0, "vulnerable_product": 0 } } ,
              { "retrieve": "cves", "dict_filter": { "vulnerable_configuration": "cpe:2.3:a:yargs:yargs-parser:15.4.1:*:*:*:*:node.js:*:*" }, "limit": 10, "query_filter": { "access": 0, "cwe": 0, "vulnerable_configuration": 0, "vulnerable_product": 0 } } 
            ]

    response = requests.post(URL, json=JSON)
    response_json = json.loads(response.text)
    return response_json

print(getblock())